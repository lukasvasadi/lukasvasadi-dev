import{s as Oe,n as Ge}from"./scheduler.ae1baad1.js";import{S as Ee,i as Ue,g as a,s as l,r as Ne,H as K,h as o,z as i,c as p,u as Re,j as J,D as Y,f as e,k as Q,a as s,v as ze,d as De,t as je,w as We}from"./index.171b1fb8.js";import{T as qe}from"./tag.e008a716.js";function Xe(Me){let u,qt='<img src="/images/stm32.jpg" alt="STM32 Nucleo board"/>',V,r,Xt="Contents",Z,c,$t='<li><a href="#introduction">Introduction</a></li> <li><a href="#setup">Setup</a></li> <li><a href="#interrupts">Interrupts</a></li>',tt,d,Bt='<a id="introduction">Introduction</a>',et,f,Ft='This guide details environment setup for programming <a href="https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html" rel="nofollow">STM32</a> microcontrollers (MCUs). It also covers general low-level functionality, such as configuring IO-based interrupts. The ST website provides a listing of various MCUs for special use cases, e.g., “High Performance,” “Ultra Low Power.” However, if you are unsure about the specific project requirements, simply choose an option from the “Mainstream MCUs.”',nt,m,Kt="Why use STM32?",st,h,Jt='STM32 microcontrollers are generally considered an industry standard technology, as opposed to Arduino, which, until the release of the <a href="https://www.arduino.cc/pro/" rel="nofollow">Pro</a> series, has served primarily an educational purpose. Compared to conventional Arduino boards, as well as the multitude of third-party MCU boards created for the Arduino platform, STM32 often provides more performance for substantially less cost. For example, the difference in processing speeds between ST and Arduino dev boards of similar costs can be upwards of 50 MHz.',at,k,Yt="What are the barriers to entry?",lt,v,Qt="Over the years, especially with the introduction of Arduino, MCU development has become simpler and streamlined. This is due to greater abstraction, which no longer requires users to understand the build process. In the case of the Arduino and STM32Cube IDEs, the developer usually selects a board from a preconfigured list and presses “play” to build and flash the chipset.",ot,_,Vt="However, while greater abstraction has certainly made STM32 development approachable, this platform still demands a greater level of understanding, both of the hardware and firmware, than Arduino. Specifically, STM32 development frequently involves configuring low-level pinout functions, clocks, and timers, as well as explicit reading and writing of registers. This can be a daunting task for inexperienced engineers and hobbyists, but with dedication and a little effort, the reward can be extraordinary.",pt,w,it,C,Zt='<a id="setup">Setup</a>',ut,x,te="This setup is suitable for Windows, Linux, and macOS. The main requirements are as follows:",rt,b,ee="<li><strong>STM32CubeMX</strong> Graphical tool for configuring STM32 microcontrollers</li> <li><strong>ST-LINK</strong> Software utility for flashing STM32 chips over USB</li> <li><strong>GNU ARM toolchain</strong> Cross-platform toolchain for compiling C/C++ source</li> <li><strong>OpenOCD</strong> Open-source debugger software for microcontrollers</li>",ct,T,ne="STM32CubeMX",dt,g,se="STM32CubeMX is a graphical tool that guides the user through a standard project setup procedure. First, the user selects the chipset or board, e.g., the Nucleo-G431KB, and presses “Start Project” in the upper right-hand corner.",ft,P,ae='<img src="/images/stm32cubemx_board_selector.png" alt="STM32CubeMX IDE window"/>',mt,M,le="Next, the user is directed to a graphical representation of the MCU pinout, where green highlighting indicates that the pin has an assigned function, e.g., USART, GPIO. When a function is assigned, the user can modify its behavior through various options in the left-hand pane. For example, the USART2 pins have a global interrupt that can be enabled to allow the program to interrupt the main thread and read serial input as needed.",ht,I,oe='<img src="/images/stm32cubemx_pin_config.png" alt="STM32CubeMX IDE window"/>',kt,H,pe="GNU Arm embedded toolchain",vt,S,ie='On Windows machines, the GNU embedded toolchain for Arm microcontrollers can be installed via the executable from <a href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads" rel="nofollow">armDeveloper</a>. Alternatively, install via Chocolatey:',_t,L,wt,Ie='<code class="language-ps1">choco install gcc-arm-embedded</code>',Ct,y,ue="Linux users (Debian distros) can install the toolchain directly with the Advanced Package Tool, along with the GNU debugger:",xt,A,bt,He='<code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gcc-arm-none-eabi gdb-multiarch</code>',Tt,O,re="And macOS developers can install via Homebrew:",gt,G,Pt,Se='<code class="language-zsh">brew install --cask gcc-arm-embedded</code>',Mt,E,ce="ST-LINK utility",It,U,de="ST-LINK is a software interface for programming STM32 microcontrollers. It allows developers to read and write programs and flash the microcontroller with a full-featured GUI or CLI.",Ht,N,fe='To install ST-LINK on Windows, download the executable from <a href="https://www.st.com/en/development-tools/stsw-link004.html" rel="nofollow">st.com</a> (an email address is required to download the software).',St,R,me="For Linux:",Lt,z,yt,Le='<code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> st-utils</code>',At,D,he="For macOS:",Ot,j,Gt,ye='<code class="language-zsh">brew install stlink</code>',Et,W,ke="JetBrains CLion IDE",Ut,q,ve='ST provides an Eclipse-based IDE (<a href="https://www.st.com/en/development-tools/stm32cubeide.html" rel="nofollow">STM32CubeIDE</a>) for its microcontrollers and development boards. This IDE integrates with the STM32CubeMX graphical tool for initializing MCU pin configurations. Although the ST-supported IDE has many platform-specific features, I prefer JetBrains CLion for its stronger C/C++ language support and cleaner UI. In addition, the JetBrains developers created seemless integration with STM32CubeMX. You can download the software with a free 30-day trial from <a href="https://www.jetbrains.com/clion/" rel="nofollow">jetbrains.com/clion</a>.',Nt,X,_e='A complete guide to configuring CLion for STM32 can be found at <a href="https://www.jetbrains.com/help/clion/embedded-development.html" rel="nofollow">STM32CubeMX projects</a>. Once you have installed the compiler toolchain and dependencies, and configured the IDE, you are ready to begin development!',Rt,$,we='<a id="interrupts">Interrupts</a>',zt,B,Ce="The example below shows the source code for interrupting the main thread based on incoming serial data. This data is then used to determine the toggle state of two GPIO pins.",Dt,F,jt,Ae=`<code class="language-c"><span class="token comment">/*
    Serial pin control
    Toggle GPIO pins based on serial input
*/</span>

<span class="token keyword">const</span> <span class="token class-name">uint8_t</span> rx_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">MX_GPIO_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MX_USART2_UART_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">HAL_UART_Receive_IT</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>huart2<span class="token punctuation">,</span> rx_data<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_9<span class="token punctuation">,</span> GPIO_PIN_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_10<span class="token punctuation">,</span> GPIO_PIN_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">HAL_Delay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">HAL_UART_RxCpltCallback</span><span class="token punctuation">(</span>UART_HandleTypeDef <span class="token operator">*</span>huart<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// Prevent unused argument(s) compilation warnings</span>
    <span class="token function">UNUSED</span><span class="token punctuation">(</span>huart<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>huart<span class="token operator">-></span>Instance <span class="token operator">==</span> USART2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Receive with interrupt</span>
        <span class="token function">HAL_UART_Receive_IT</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>huart2<span class="token punctuation">,</span> rx_data<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Toggle pin 9 based on input from data buffer at position 0</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rx_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">49</span><span class="token punctuation">)</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_9<span class="token punctuation">,</span> GPIO_PIN_SET<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_9<span class="token punctuation">,</span> GPIO_PIN_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Toggle pin 10 based on input from data buffer at position 1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rx_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">49</span><span class="token punctuation">)</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_10<span class="token punctuation">,</span> GPIO_PIN_SET<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOA<span class="token punctuation">,</span> GPIO_PIN_10<span class="token punctuation">,</span> GPIO_PIN_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,Wt;return w=new qe({props:{msg:"Even though the STM32 platform requires a deeper understanding of hardware development, I have found that programming more advanced features, such as interrupts, is easier than Arduino."}}),{c(){u=a("p"),u.innerHTML=qt,V=l(),r=a("h2"),r.textContent=Xt,Z=l(),c=a("ul"),c.innerHTML=$t,tt=l(),d=a("h2"),d.innerHTML=Bt,et=l(),f=a("p"),f.innerHTML=Ft,nt=l(),m=a("h3"),m.textContent=Kt,st=l(),h=a("p"),h.innerHTML=Jt,at=l(),k=a("h3"),k.textContent=Yt,lt=l(),v=a("p"),v.textContent=Qt,ot=l(),_=a("p"),_.textContent=Vt,pt=l(),Ne(w.$$.fragment),it=l(),C=a("h2"),C.innerHTML=Zt,ut=l(),x=a("p"),x.textContent=te,rt=l(),b=a("ul"),b.innerHTML=ee,ct=l(),T=a("h3"),T.textContent=ne,dt=l(),g=a("p"),g.textContent=se,ft=l(),P=a("p"),P.innerHTML=ae,mt=l(),M=a("p"),M.textContent=le,ht=l(),I=a("p"),I.innerHTML=oe,kt=l(),H=a("h3"),H.textContent=pe,vt=l(),S=a("p"),S.innerHTML=ie,_t=l(),L=a("pre"),wt=new K(!1),Ct=l(),y=a("p"),y.textContent=ue,xt=l(),A=a("pre"),bt=new K(!1),Tt=l(),O=a("p"),O.textContent=re,gt=l(),G=a("pre"),Pt=new K(!1),Mt=l(),E=a("h3"),E.textContent=ce,It=l(),U=a("p"),U.textContent=de,Ht=l(),N=a("p"),N.innerHTML=fe,St=l(),R=a("p"),R.textContent=me,Lt=l(),z=a("pre"),yt=new K(!1),At=l(),D=a("p"),D.textContent=he,Ot=l(),j=a("pre"),Gt=new K(!1),Et=l(),W=a("h3"),W.textContent=ke,Ut=l(),q=a("p"),q.innerHTML=ve,Nt=l(),X=a("p"),X.innerHTML=_e,Rt=l(),$=a("h2"),$.innerHTML=we,zt=l(),B=a("p"),B.textContent=Ce,Dt=l(),F=a("pre"),jt=new K(!1),this.h()},l(t){u=o(t,"P",{"data-svelte-h":!0}),i(u)!=="svelte-1x2jxcf"&&(u.innerHTML=qt),V=p(t),r=o(t,"H2",{"data-svelte-h":!0}),i(r)!=="svelte-jpxk5s"&&(r.textContent=Xt),Z=p(t),c=o(t,"UL",{"data-svelte-h":!0}),i(c)!=="svelte-10czy6v"&&(c.innerHTML=$t),tt=p(t),d=o(t,"H2",{"data-svelte-h":!0}),i(d)!=="svelte-117zo8l"&&(d.innerHTML=Bt),et=p(t),f=o(t,"P",{"data-svelte-h":!0}),i(f)!=="svelte-17tv8z7"&&(f.innerHTML=Ft),nt=p(t),m=o(t,"H3",{"data-svelte-h":!0}),i(m)!=="svelte-1ox5jh7"&&(m.textContent=Kt),st=p(t),h=o(t,"P",{"data-svelte-h":!0}),i(h)!=="svelte-kyw9z5"&&(h.innerHTML=Jt),at=p(t),k=o(t,"H3",{"data-svelte-h":!0}),i(k)!=="svelte-pglehj"&&(k.textContent=Yt),lt=p(t),v=o(t,"P",{"data-svelte-h":!0}),i(v)!=="svelte-ff6dr3"&&(v.textContent=Qt),ot=p(t),_=o(t,"P",{"data-svelte-h":!0}),i(_)!=="svelte-1vmdeoa"&&(_.textContent=Vt),pt=p(t),Re(w.$$.fragment,t),it=p(t),C=o(t,"H2",{"data-svelte-h":!0}),i(C)!=="svelte-1kkpotz"&&(C.innerHTML=Zt),ut=p(t),x=o(t,"P",{"data-svelte-h":!0}),i(x)!=="svelte-1n5c3d4"&&(x.textContent=te),rt=p(t),b=o(t,"UL",{"data-svelte-h":!0}),i(b)!=="svelte-1pkeqnf"&&(b.innerHTML=ee),ct=p(t),T=o(t,"H3",{"data-svelte-h":!0}),i(T)!=="svelte-11sfqkb"&&(T.textContent=ne),dt=p(t),g=o(t,"P",{"data-svelte-h":!0}),i(g)!=="svelte-w2w5vz"&&(g.textContent=se),ft=p(t),P=o(t,"P",{"data-svelte-h":!0}),i(P)!=="svelte-1ipdc0e"&&(P.innerHTML=ae),mt=p(t),M=o(t,"P",{"data-svelte-h":!0}),i(M)!=="svelte-y51dpv"&&(M.textContent=le),ht=p(t),I=o(t,"P",{"data-svelte-h":!0}),i(I)!=="svelte-h10ohk"&&(I.innerHTML=oe),kt=p(t),H=o(t,"H3",{"data-svelte-h":!0}),i(H)!=="svelte-17a8ahz"&&(H.textContent=pe),vt=p(t),S=o(t,"P",{"data-svelte-h":!0}),i(S)!=="svelte-1vanu5b"&&(S.innerHTML=ie),_t=p(t),L=o(t,"PRE",{class:!0});var n=J(L);wt=Y(n,!1),n.forEach(e),Ct=p(t),y=o(t,"P",{"data-svelte-h":!0}),i(y)!=="svelte-1s4vtuf"&&(y.textContent=ue),xt=p(t),A=o(t,"PRE",{class:!0});var xe=J(A);bt=Y(xe,!1),xe.forEach(e),Tt=p(t),O=o(t,"P",{"data-svelte-h":!0}),i(O)!=="svelte-ax5wbf"&&(O.textContent=re),gt=p(t),G=o(t,"PRE",{class:!0});var be=J(G);Pt=Y(be,!1),be.forEach(e),Mt=p(t),E=o(t,"H3",{"data-svelte-h":!0}),i(E)!=="svelte-96q1qk"&&(E.textContent=ce),It=p(t),U=o(t,"P",{"data-svelte-h":!0}),i(U)!=="svelte-cm1xgg"&&(U.textContent=de),Ht=p(t),N=o(t,"P",{"data-svelte-h":!0}),i(N)!=="svelte-b8j1wi"&&(N.innerHTML=fe),St=p(t),R=o(t,"P",{"data-svelte-h":!0}),i(R)!=="svelte-38b54n"&&(R.textContent=me),Lt=p(t),z=o(t,"PRE",{class:!0});var Te=J(z);yt=Y(Te,!1),Te.forEach(e),At=p(t),D=o(t,"P",{"data-svelte-h":!0}),i(D)!=="svelte-15zavxg"&&(D.textContent=he),Ot=p(t),j=o(t,"PRE",{class:!0});var ge=J(j);Gt=Y(ge,!1),ge.forEach(e),Et=p(t),W=o(t,"H3",{"data-svelte-h":!0}),i(W)!=="svelte-168lvrd"&&(W.textContent=ke),Ut=p(t),q=o(t,"P",{"data-svelte-h":!0}),i(q)!=="svelte-1foz4h8"&&(q.innerHTML=ve),Nt=p(t),X=o(t,"P",{"data-svelte-h":!0}),i(X)!=="svelte-13xxkx3"&&(X.innerHTML=_e),Rt=p(t),$=o(t,"H2",{"data-svelte-h":!0}),i($)!=="svelte-wssnud"&&($.innerHTML=we),zt=p(t),B=o(t,"P",{"data-svelte-h":!0}),i(B)!=="svelte-15zrrup"&&(B.textContent=Ce),Dt=p(t),F=o(t,"PRE",{class:!0});var Pe=J(F);jt=Y(Pe,!1),Pe.forEach(e),this.h()},h(){wt.a=null,Q(L,"class","language-ps1"),bt.a=null,Q(A,"class","language-bash"),Pt.a=null,Q(G,"class","language-zsh"),yt.a=null,Q(z,"class","language-bash"),Gt.a=null,Q(j,"class","language-zsh"),jt.a=null,Q(F,"class","language-c")},m(t,n){s(t,u,n),s(t,V,n),s(t,r,n),s(t,Z,n),s(t,c,n),s(t,tt,n),s(t,d,n),s(t,et,n),s(t,f,n),s(t,nt,n),s(t,m,n),s(t,st,n),s(t,h,n),s(t,at,n),s(t,k,n),s(t,lt,n),s(t,v,n),s(t,ot,n),s(t,_,n),s(t,pt,n),ze(w,t,n),s(t,it,n),s(t,C,n),s(t,ut,n),s(t,x,n),s(t,rt,n),s(t,b,n),s(t,ct,n),s(t,T,n),s(t,dt,n),s(t,g,n),s(t,ft,n),s(t,P,n),s(t,mt,n),s(t,M,n),s(t,ht,n),s(t,I,n),s(t,kt,n),s(t,H,n),s(t,vt,n),s(t,S,n),s(t,_t,n),s(t,L,n),wt.m(Ie,L),s(t,Ct,n),s(t,y,n),s(t,xt,n),s(t,A,n),bt.m(He,A),s(t,Tt,n),s(t,O,n),s(t,gt,n),s(t,G,n),Pt.m(Se,G),s(t,Mt,n),s(t,E,n),s(t,It,n),s(t,U,n),s(t,Ht,n),s(t,N,n),s(t,St,n),s(t,R,n),s(t,Lt,n),s(t,z,n),yt.m(Le,z),s(t,At,n),s(t,D,n),s(t,Ot,n),s(t,j,n),Gt.m(ye,j),s(t,Et,n),s(t,W,n),s(t,Ut,n),s(t,q,n),s(t,Nt,n),s(t,X,n),s(t,Rt,n),s(t,$,n),s(t,zt,n),s(t,B,n),s(t,Dt,n),s(t,F,n),jt.m(Ae,F),Wt=!0},p:Ge,i(t){Wt||(De(w.$$.fragment,t),Wt=!0)},o(t){je(w.$$.fragment,t),Wt=!1},d(t){t&&(e(u),e(V),e(r),e(Z),e(c),e(tt),e(d),e(et),e(f),e(nt),e(m),e(st),e(h),e(at),e(k),e(lt),e(v),e(ot),e(_),e(pt),e(it),e(C),e(ut),e(x),e(rt),e(b),e(ct),e(T),e(dt),e(g),e(ft),e(P),e(mt),e(M),e(ht),e(I),e(kt),e(H),e(vt),e(S),e(_t),e(L),e(Ct),e(y),e(xt),e(A),e(Tt),e(O),e(gt),e(G),e(Mt),e(E),e(It),e(U),e(Ht),e(N),e(St),e(R),e(Lt),e(z),e(At),e(D),e(Ot),e(j),e(Et),e(W),e(Ut),e(q),e(Nt),e(X),e(Rt),e($),e(zt),e(B),e(Dt),e(F)),We(w,t)}}}const Ke={title:"Programming STM32 MCUs",description:"Configure a development environment with CLion and learn basic MCU functions",date:"2023-8-31",image:"/images/stm32.jpg",categories:["STM32","Microcontrollers","Interrupts","Serial communication"],published:!0};class Je extends Ee{constructor(u){super(),Ue(this,u,null,Xe,Oe,{})}}export{Je as default,Ke as metadata};
